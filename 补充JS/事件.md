# 事件

## 1. DOM事件流

### 1.1 是什么？

- 事件流描述的是从`页面中接收事件的顺序`。
- `事件发生时会在元素节点之间按照特定的顺序传播`，这个传播过程即 DOM 事件流。

### 1.2 DOM 事件流分为`3个阶段`：

1. 捕获阶段。事件捕获： 网景最早提出，`由 DOM 最顶层节点开始`，然后`逐级向下传播`到`到最具体的元素接收`的过程
2. 当前目标阶段
3.  冒泡阶段。事件冒泡： IE 最早提出，事件`开始时由最具体的元素接收`，然后`逐级向上传播到到 DOM 最顶层节点的过程`。**`通俗理解就是，我点击了儿子，点击这个事件就会向上传递，告诉父亲以及父亲的父亲等等，我被点击了，如果父亲绑定了点击事件的回调函数，就会被触发`**

![img](https://api2.mubu.com/v3/document_image/ce847b43-7f6b-4d03-96a6-c731447f73cf-10071129.jpg)

我们向水里面扔一块石头，首先它会有一个下降的过程，这个过程就可以理解为从最顶层向事件发生的最具体元素（目标点）的捕获过程；之后会产生泡泡，会在最低点（ 最具体元素）之后漂浮到水面上，这个过程相当于事件冒泡。

### 1.3注意事项

1. .JS 代码中**`只能执行捕获或者冒泡其中的一个阶段`**。
2. onclick 和 attachEvent 只能得到冒泡阶段。
3. addEventListener(type, listener[, useCapture])第三个参数如果是 true，表示在事件捕获阶段调用事件处理程序；`如果是 false（不写默认就是false），表示在事件冒泡阶段调用事件处理程序`。

## 2. 事件对象

### 2.1 什么是事件对象

- 事件发生后，跟`事件相关的一系列信息数据的集合都放到这个对象里面`，这个对象就是**`事件对象event`**，它有很多属性和方法。
- 当我们注册事件时， event 对象就会被系统自动创建，并依次传递给事件监听器（事件处理函数）。**`也就是说event是系统帮忙获取的，直接用就可以，如何用？要把它写在参数那部分`**

- 比如： 
  -  谁绑定了这个事件。
  - 鼠标触发事件的话，会得到鼠标的相关信息，如鼠标位置。
  -  键盘触发事件的话，会得到键盘的相关信息，如按了哪个键

### 2.2 如何使用事件对象

- **`直接在回调函数的参数上写event`**。event对象里的具体内容，系统会帮我们获取

![img](https://api2.mubu.com/v3/document_image/9596e586-3eb4-45df-aab7-2ff1d9b4662e-10071129.jpg)

- 这个`event 是个形参`，`系统帮我们设定为事件对象`，不需要传递实参过去。
- 当我们`注册事件`时， **`event 对象就会被系统自动创建`**，并依次传递给事件监听器（事件处理函数）。

### 2.3 事件对象的常见属性和方法

![img](https://api2.mubu.com/v3/document_image/1fd9be56-9d06-4c28-b772-672e3d029ce3-10071129.jpg)

#### 2.3.1 e.target和回调函数里的this的区别

- ` this` 是**`事件绑定的元素`**， 这个`函数的调用者`（绑定这个事件的元素）
-  `e.target` 是**`事件触发的元素`**。
- 简单说：**`e.target点击了哪个元素就返回哪个`**，**`this哪个元素绑定了事件就返回哪个`**。**`有些时候两者一样，如果给父盒子绑定了事件，而点击了子盒子，就会产生e.target与this的不同`**

#### 2.3.2 `阻止事件冒泡`

- 事件冒泡有好处也有坏处
- 好处是，当我们需要给多个子元素绑定相同的事件时。我们可以通过给父元素绑定事件，利用事件冒泡的特性，就能够达到同样的效果
- 坏处时，`当我们只想要在点击父盒子才触发事件，点击子盒子不触发，但大多数事件默认是事件冒泡`。所以要阻止

![image-20220126113325822](C:\Users\zayn\AppData\Roaming\Typora\typora-user-images\image-20220126113325822.png)

## 3. **事件委托（代理、委派）**

### 3.1 事件委托的`原理`

- 不是每个子节点单独设置事件监听器，而是`事件监听器设置在其父节点`上，然后利用**`冒泡原理`**`影响设置每个子节点`。
- 以下通过`给 ul 注册点击事件`，**`然后利用e.target 来找到当前点击的 li然后就可以对li进行操作`**，因为点击 li，事件（点击）会冒泡到 ul 上，

![img](https://api2.mubu.com/v3/document_image/d632727c-8d10-4121-b34b-15b2a7f97bba-10071129.jpg)

``` html
<body>
    <div class="container" id="container">
        <button>按钮1</button>
        <button>按钮2</button>
        <div>显示框</div>
    </div>
    <script>
        let container = document.getElementById('container');
        container.addEventListener('click', (e) => {
            let box = e.target;
            box.innerText = "Hello";
            console.log(1);
        })
    </script>
</body>
```



### 3.2 事件委托的`作用`

- 点击每个 li 都会弹出对话框，以前需要给每个 li 注册事件，是非常辛苦的，而且访问 DOM 的次数越多，这就会延长整个页面的交互就绪时间。
- 我们`只操作了一次 DOM ，提高了程序的性能`。