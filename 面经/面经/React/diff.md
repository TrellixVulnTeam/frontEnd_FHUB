## 1.状态改变后会怎么样?/讲一下diff

在初始化时，React 调用 `render()` 方法，会创建一棵由 React 元素组成的树。在下一次 **`state`** 或**` props`** 更新时，相同的 `render()` 方法会返回一棵不同的树。React 需要基于这两棵树(两个虚拟DOM)之间的差别来判断如何有效率的更新 UI 以保证当前 UI 与最新的树保持同步。

一开始是**`Tree diff`**：对新旧两棵树之间进行逐层对比，`找出哪些节点需要更新`。如果节点是`组件`进行`Component diff`，如果节点是`标签`进行`Element diff`

这样命名是因为diff过程是递归的，描述比较方便

在**`Component diff`**里，先`对比组件的类型`，如果类型都不同，记录这个替换或者是删除的操作，然后结束该层的递归，不对比后面的了；如果只是`属性不同`，那么更新属性，然后深入组件进行递归Tree diff；如果都一样，深入组件进行递归Tree diff

在**`Element diff`**里，先`对比标签名`，如果标签名不同，记录这个替换或是删除的操作，然后结束该层递归，不对比后面的了；如果只是`属性不同`，那么更新属性，然后进入标签后代进行递归Tree diff；如果都一样，进入标签后代进行递归Tree diff



## 2.为什么用虚拟DOM

虚拟DOM是一个对象，通常包含有标签名，属性和子元素等等

虽然`虚拟DOM操作DOM肯定没有原生JS操作DOM快`，但是它可以`减少DOM操作的次数`。首先是可以**`将多次操作合并为一次操作`**，比如新增1000个节点，JS是一个接着一个节点进行操作的，而虚拟DOM是一次性操作1000个节点。同时虚拟DOM还可以**`借助diff算法将多余的操作省掉`**，比如这1000个节点里其实只有10个新增的，那么虚拟DOM只会操作这10个节点

另外**`虚拟DOM可以跨平台`**，因为虚拟DOM本质是一个js对象，不仅可以变成DOM，还可以变成小程序、安卓应用等等