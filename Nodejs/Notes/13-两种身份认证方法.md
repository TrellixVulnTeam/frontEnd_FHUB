## 两种身份验证流程

### 1.`session`的身份验证流程(基于cookie)

1. 用户输入登录信息；
2. `服务器验证登录信息`是否正确，如果`正确就创建一个session`，并把session`存入数据库`
3. `服务器端向客户端`返回 `带有sessionID(标识session)的cookie`
4. 在接下来`前端发起的每次请求都会带上cookie`，`服务器`把`cookie里的sessionID与数据库中的相匹配，`如果有效则处理该请求
5. 如果用户`退出登录`，`session`会在`客户端`和`服务端`都被销毁

### 2.`JWT`(json web token)身份验证流程(基于localStorage)

1. 用户输入登录信息；
2. `服务器验证登录信息`是否正确，如果`正确就返回一个已签名的token(加密字符串)`；
3. `前端`将`token`存储在`客户端`，一般存储在`localStorage`中，但是也可存在sessionStorage和cookie中
4. 在接下来`前端发起的每次请求都会带上token`
5. `服务器验证token`，如果token有效则继续处理这个请求
6. 如果用户`退出登录`，token会`在客户端销毁`，这一步与服务器无关。

## JWT与session的区别

1. `用户状态保存的位置`，`session`将用户状态保存在`服务端，`而`JWT`将用户状态保存在`客户端`
2. `session依赖于cookie`实现，`每次请求都需要带上cookie`，`取出相应字段并与服务器端的进行对比，`以实现身份认证。而`JWT`仅仅需要`在HTTP的头部附上token`，由`服务器check signature`即可实现，无须担心cookie存在的CORS问题

## JWT与session的优缺点

### 扩展性

- 当应用程序是分布式部署的情况下，session在服务端需要做多机数据共享，因此需要保存在数据库或者redis里面。而JWT的数据都保存在客户端，，不需要做其他的处理

### 无状态

- JWT不在服务端存储 任何状态。RESTful API的原则之一就是无状态，发出请求时，总会返回带有参数的响应，不会产生附加影响。用户的认证状态引入这种附加影响，就破坏了这一原则。另外JWT的载荷中可以存储一些常用信息，用于交换信息，有效地使用JWT，可以降低服务器查询数据库的次数

###  安全性

- 由于JWT的payload是使用base64编码的，并没有加密，因此JWT中不能存储敏感数据。而session的信息是存在服务端的。相对来说更安全。

### 性能

- 由于是 无状态使用JWT，所有的数据都被放到JWT里，如果还要进行一些数据交换，载荷会更大，经过编码之后导致JWT非常长，而由于cookie的限制大小一般是4k，cookie很可能放不下。所以JWT一般放在localStorage里面，并且用户在系统中的每一次HTTP请求都会把JWT携带在Header里面，HTTP请求的Header可能比Body还要大。而如果是sessionID的话，就只是很短的一个字符串，因此使用JWT的HTTP请求比使用session的开销大得多。